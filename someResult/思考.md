## 一些设置

eps { horse:1,xxx_car:1 , carsten:0.1,flowers:0.01}

根据设置的不同，速度最快能在0.3s，最慢可能3s往上

## 算法瓶颈

### 应用瓶颈

观察到在物体边缘分割比较好，但是有的时候在背景边缘以外效果又下降，我认为grabcut的本质只是按照了颜色进行分类，以及考虑相邻格之间的关系，没有考虑到空间整体位置之间的关系。

### 时间瓶颈

网络流的复杂度基本在$V^2E$

注定GrabCut不能处理巨大的图片。

（不过我的代码里面的瓶颈在于EM算法。）

## 问题与思考

### GMM

GMM中的簇类表示了颜色在空间的概率密度分布，每个簇也就是高斯分布聚合了一些颜色，当簇类太多的时候可能导致过拟合，以及拉高了复杂度。

eps的选取也会影响效果，例子是horse只有黑绿两类时，前后背景都有绿时前景簇可能拟合到绿色，从而导致效果的不佳。

用calcCovarMatrix计算协方差矩阵必须手动 / n。

为了避免协方差矩阵行列式为0， 正则化协方差矩阵，即加上极小值。

虽然高斯分布的式子$ p(x|\mu,\sigma) = \frac{1}{(2*\pi)^{\frac{3}{2}}*|\sigma|^2}*e^{-\frac{1}{2}(x-\mu)^T*\sigma^{-1}*(x-\mu)} $

但是因为图片的像素比较多，实际上算出来的p一般都很小，

直接用这个式子效果不太好，所以直接整体乘了一个大常数。

### 网络流

有时候多次迭代网络流的效果不好，当错误的把前景归结为背景之后，之后的迭代可能继续加强这种错误。

## GMM颜色模型换成颜色直方图

首要问题还是直接做颜色直方图空间$256^3$ 太大，要压缩成$12^3$ 应该会失真，平滑操作也是为了减少这种操作带来的噪声。

其次我认为，当GMM换成颜色直方图时，可能不能很好表示占比较低的颜色在前景的情况，在GMM中可能可以用一个簇学习到的颜色信息就被忽略掉了。

另外，因为要以直方图的形式来表示，可能在每个边界[12]左右两边的颜色关系不大，所以才会选择先在颜色空间量化，再去直方图内求解概率。

